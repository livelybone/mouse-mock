<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MouseMock</title>

  <!-- Inject some helpers for code running. It is not needed in a real project when you configured babel-polyfill or there is no new feature of js which is used in the project -->
  <!-- 为代码运行注入一些babel帮助函数。在真正的babel项目中，当已配置 babel-polyfill 时，或者js没有新特性时，并不需要它 -->
  <script src="https://cdn.jsdelivr.net/npm/@babel/polyfill/dist/polyfill.min.js"></script>

  <script src="../lib/umd/index.js"></script>
  <style>
    iframe {
      width: 100%;
      height: 300px;
    }
  </style>
</head>
<body>
<div id="module" style="height: 200vh">
  <div style="height: 200px"></div>
  <iframe id="iframe1" src="https://baidu.com"></iframe>
  <iframe id="iframe" src="./test1.html"></iframe>
  <div style="height: 10px">
    <button id="btn" onclick="console.log(event)" style="width: 200px; height: 200px; border-radius: 50%">
      <span class="1" style="pointer-events: none">点击触发真实 click 事件</span>
      <span class="2">!!!!!</span>
    </button>
    <button onclick="mockClick()">点击触发模拟的 click 事件</button>
    <button onclick="clickElInnerIframe()">点击触发 iframe 内部元素模拟的 click 事件</button>
  </div>
  <div id="dot" style="position: fixed;width: 3px;height: 3px;background: red"></div>
  <div id="dot1" style="position: fixed;width: 3px;height: 3px;background: red"></div>
</div>

<script>
var module = document.getElementById('module')
var btn = document.getElementById('btn')
// do something ...

function mockClick() {
  MouseMock.mockClick(btn)
}

btn.addEventListener('click', ev => console.log('addEventListener click', ev))
btn.onclick = (ev) => console.log(3, ev, ev.currentTarget.onclick)
btn.ondblclick = (ev) => console.log(4, ev, ev.currentTarget.onclick)

function logPosEl() {
  console.log(document.elementsFromPoint(20, 20))
}

function clickElInnerIframe() {
  const rect = Math.random() > 0.5 ? document.querySelector('#iframe1').getBoundingClientRect() : document.querySelector('#iframe').contentWindow.document.querySelector('#btn')
  console.log(1111, rect)
  const point = MouseMock.mockClick(rect)
  if (point) {
    const dot = document.querySelector('#dot')
    const dot1 = document.querySelector('#dot1')
    dot.style.top = (point && point.originPoint.clientY) + 'px'
    dot.style.left = (point && point.originPoint.clientX) + 'px'
    dot1.style.top = (point && point.point.clientY) + 'px'
    dot1.style.left = (point && point.point.clientX) + 'px'
  }
}
</script>
</body>
</html>
